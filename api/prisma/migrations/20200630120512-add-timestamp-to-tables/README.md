# Migration `20200630120512-add-timestamp-to-tables`

This migration has been generated by Michael Vieira at 6/30/2020, 12:05:12 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Logement" (
"created_at" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"default_price" INTEGER NOT NULL  ,"deleted_at" DATE   ,"id" TEXT NOT NULL  ,"in_maintenance" BOOLEAN NOT NULL DEFAULT false ,"location" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,"type" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("type") REFERENCES "Logement"("id") ON DELETE CASCADE ON UPDATE CASCADE)

INSERT INTO "quaint"."new_Logement" ("default_price", "id", "in_maintenance", "location", "name", "type") SELECT "default_price", "id", "in_maintenance", "location", "name", "type" FROM "quaint"."Logement"

PRAGMA foreign_keys=off;
DROP TABLE "quaint"."Logement";;
PRAGMA foreign_keys=on

ALTER TABLE "quaint"."new_Logement" RENAME TO "Logement";

CREATE UNIQUE INDEX "quaint"."Logement.name" ON "Logement"("name")

ALTER TABLE "quaint"."Employe" ADD COLUMN "deleted_at" DATE   ;

CREATE TABLE "quaint"."new_Reservation" (
"check_in" DATE   ,"check_out" DATE   ,"client" TEXT NOT NULL  ,"created_at" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"deleted_at" DATE   ,"end_date" DATE NOT NULL  ,"id" TEXT NOT NULL  ,"logement" TEXT NOT NULL  ,"price" INTEGER NOT NULL  ,"start_date" DATE NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("client") REFERENCES "Client"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("logement") REFERENCES "Logement"("id") ON DELETE CASCADE ON UPDATE CASCADE)

INSERT INTO "quaint"."new_Reservation" ("check_in", "check_out", "client", "end_date", "id", "logement", "price", "start_date") SELECT "check_in", "check_out", "client", "end_date", "id", "logement", "price", "start_date" FROM "quaint"."Reservation"

PRAGMA foreign_keys=off;
DROP TABLE "quaint"."Reservation";;
PRAGMA foreign_keys=on

ALTER TABLE "quaint"."new_Reservation" RENAME TO "Reservation";

ALTER TABLE "quaint"."Client" ADD COLUMN "deleted_at" DATE   ;

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200629234554-init_db..20200630120512-add-timestamp-to-tables
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -17,8 +17,10 @@
   LogementType Logement @relation(fields: [type])
   location String
   default_price Int
   in_maintenance Boolean @default(false)
+  created_at DateTime @default(now())
+  deleted_at DateTime?
 }
 model LogementType {
   id String @id @default(cuid())
@@ -44,8 +46,9 @@
   password String
   email String
   disabled Boolean @default(false)
   created_at DateTime @default(now())
+  deleted_at DateTime?
 }
 model Role {
   id String @id @default(cuid())
@@ -63,8 +66,10 @@
   start_date DateTime
   end_date DateTime
   check_in DateTime?
   check_out DateTime?
+  created_at DateTime @default(now())
+  deleted_at DateTime?
 }
 model EtatLieu {
   id String @id @default(cuid())
@@ -85,5 +90,6 @@
   phone_number String
   email String @unique
   banned Boolean @default(false)
   created_at DateTime @default(now())
+  deleted_at DateTime?
 }
```


