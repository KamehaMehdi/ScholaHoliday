# Migration `20200629234554-init_db`

This migration has been generated by Michael Vieira at 6/29/2020, 11:45:54 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."Logement" (
"default_price" INTEGER NOT NULL  ,"id" TEXT NOT NULL  ,"in_maintenance" BOOLEAN NOT NULL DEFAULT false ,"location" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,"type" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("type") REFERENCES "Logement"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."LogementType" (
"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,
    PRIMARY KEY ("id"))

CREATE TABLE "quaint"."Evenement" (
"created_at" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"employe" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"logement" TEXT NOT NULL  ,"tache" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("logement") REFERENCES "Logement"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("employe") REFERENCES "Employe"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Employe" (
"created_at" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"disabled" BOOLEAN NOT NULL DEFAULT false ,"email" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,"password" TEXT NOT NULL  ,"role" TEXT NOT NULL  ,"username" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("role") REFERENCES "Role"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Role" (
"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,"permission" TEXT NOT NULL  ,
    PRIMARY KEY ("id"))

CREATE TABLE "quaint"."Reservation" (
"check_in" DATE   ,"check_out" DATE   ,"client" TEXT NOT NULL  ,"end_date" DATE NOT NULL  ,"id" TEXT NOT NULL  ,"logement" TEXT NOT NULL  ,"price" INTEGER NOT NULL  ,"start_date" DATE NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("client") REFERENCES "Client"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("logement") REFERENCES "Logement"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."EtatLieu" (
"created_at" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"employe" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"logement" TEXT NOT NULL  ,"report" TEXT NOT NULL  ,"reservation" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("reservation") REFERENCES "Reservation"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("logement") REFERENCES "Logement"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("employe") REFERENCES "Employe"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Client" (
"address" TEXT NOT NULL  ,"banned" BOOLEAN NOT NULL DEFAULT false ,"created_at" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"email" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,"phone_number" TEXT NOT NULL  ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "quaint"."Logement.name" ON "Logement"("name")

CREATE UNIQUE INDEX "quaint"."LogementType.name" ON "LogementType"("name")

CREATE UNIQUE INDEX "quaint"."Employe.username" ON "Employe"("username")

CREATE UNIQUE INDEX "quaint"."Client.name" ON "Client"("name")

CREATE UNIQUE INDEX "quaint"."Client.email" ON "Client"("email")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200629234554-init_db
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,89 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "sqlite"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Logement {
+  id String @id @default(cuid())
+  name String @unique
+  type String
+  LogementType Logement @relation(fields: [type])
+  location String
+  default_price Int
+  in_maintenance Boolean @default(false)
+}
+
+model LogementType {
+  id String @id @default(cuid())
+  name String @unique
+}
+
+model Evenement {
+  id String @id @default(cuid())
+  logement String
+  Logement Logement @relation(fields: [logement])
+  employe String
+  Employe Employe @relation(fields: [employe])
+  tache String
+  created_at DateTime @default(now())
+}
+
+model Employe {
+  id String @id @default(cuid())
+  name String
+  role String
+  Role Role @relation(fields: [role])
+  username String @unique
+  password String
+  email String
+  disabled Boolean @default(false)
+  created_at DateTime @default(now())
+}
+
+model Role {
+  id String @id @default(cuid())
+  name String
+  permission String
+}
+
+model Reservation {
+  id String @id @default(cuid())
+  client String
+  Client Client @relation(fields: [client])
+  logement String
+  Logement Logement @relation(fields: [logement])
+  price Int
+  start_date DateTime
+  end_date DateTime
+  check_in DateTime?
+  check_out DateTime?
+}
+
+model EtatLieu {
+  id String @id @default(cuid())
+  reservation String
+  logement String
+  employe String
+  Reservation Reservation @relation(fields: [reservation])
+  Logement Logement @relation(fields: [logement])
+  Employe Employe @relation(fields: [employe])
+  report String
+  created_at DateTime @default(now())
+}
+
+model Client {
+  id String @id @default(cuid())
+  name String @unique
+  address String
+  phone_number String
+  email String @unique
+  banned Boolean @default(false)
+  created_at DateTime @default(now())
+}
```


